<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Or√ßamentos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FF6B35 0%, #FFA500 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .logo-container {
            margin-bottom: 20px;
        }

        .logo {
            width: 250px;
            height: 100px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
            object-fit: contain;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #FF6B35;
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group textarea {
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input[readonly] {
            background: #f8f9fa;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #dee2e6;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary { background: linear-gradient(135deg, #FF6B35 0%, #FFA500 100%); color: white; }
        .btn-success { background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); color: white; padding: 8px 15px; font-size: 0.9rem; }
        
        .items-table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .items-table th { background: linear-gradient(135deg, #FF6B35 0%, #FFA500 100%); color: white; padding: 15px; text-align: left; font-weight: 600; }
        .items-table td { padding: 15px; border-bottom: 1px solid #e9ecef; }
        .total-section { background: linear-gradient(135deg, #FF6B35 0%, #FFA500 100%); color: white; padding: 25px; border-radius: 15px; text-align: right; margin-top: 20px; }
        .total-section h3 { font-size: 1.8rem; margin-bottom: 10px; }
        .total-section p { font-size: 2.5rem; font-weight: 700; }
        .empty-state { text-align: center; padding: 40px; color: #6c757d; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 10000; backdrop-filter: blur(5px); }
        .modal-content { background: white; border-radius: 20px; padding: 40px; max-width: 500px; width: 90%; box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3); }
        .modal-header { text-align: center; margin-bottom: 30px; }
        .share-options { display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 30px; }
        .share-option { display: flex; align-items: center; gap: 15px; padding: 20px; border: 2px solid #e9ecef; border-radius: 15px; cursor: pointer; transition: all 0.3s ease; }
        .share-option:hover { border-color: #FF6B35; background: #fff5f2; transform: translateY(-2px); }
        .share-option-icon { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; flex-shrink: 0; }
        .share-option-content h3 { margin: 0 0 5px 0; color: #2c3e50; }
        .share-option-content p { margin: 0; color: #6c757d; font-size: 0.9rem; }
        
        .download-icon { background: linear-gradient(135deg, #FF6B35 0%, #FFA500 100%); }
        .image-icon { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .whatsapp-icon { background: linear-gradient(135deg, #25d366 0%, #128c7e 100%); }
        
        .modal-footer { text-align: center; padding-top: 20px; border-top: 1px solid #e9ecef; }
        .btn-close { background: #6c757d; color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="https://i.imgur.com/zerV906.png" alt="Fenix Fardamentos Logo" class="logo">
            </div>
            <h1>Gerador de Or√ßamentos</h1>
        </div>
        <div class="content">
            <div class="section">
                <h2>üè¢ Dados da Empresa</h2>
                <div class="form-grid">
                    <div class="form-group"><label>Nome</label><input type="text" value="Fenix Fardamentos LTDA" readonly></div>
                    <div class="form-group"><label>CNPJ</label><input type="text" value="12.000.234/0001-18" readonly></div>
                    <div class="form-group"><label>Endere√ßo</label><input type="text" value="Rua Pinheiro, 65 - Cidade Universit√°ria" readonly></div>
                    <div class="form-group"><label>Telefone</label><input type="text" value="(82) 98814-4752" readonly></div>
                    <div class="form-group"><label>E-mail</label><input type="email" value="fenixfardamentos.al@gmail.com" readonly></div>
                </div>
            </div>

            <div class="section">
                <h2>üë§ Dados do Cliente</h2>
                <div class="form-grid">
                    <div class="form-group"><label for="clienteNome">Nome do Cliente *</label><input type="text" id="clienteNome" placeholder="Nome completo ou empresa" required></div>
                    <div class="form-group"><label for="clienteEmail">E-mail do Cliente</label><input type="email" id="clienteEmail" placeholder="cliente@email.com"></div>
                    <div class="form-group"><label for="clienteTelefone">Telefone do Cliente</label><input type="text" id="clienteTelefone" placeholder="(11) 99999-9999" oninput="formatarTelefone(this)"></div>
                </div>
            </div>

            <div class="section">
                <h2>üì¶ Adicionar Itens ao Or√ßamento</h2>
                <div class="form-grid">
                    <div class="form-group"><label for="itemDescricao">Descri√ß√£o do Item *</label><input type="text" id="itemDescricao" placeholder="CAMISA UV" required></div>
                    <div class="form-group"><label for="itemQuantidade">Quantidade *</label><input type="number" id="itemQuantidade" min="1" value="1" required></div>
                    <div class="form-group"><label for="itemValorUnitario">Valor Unit√°rio (R$) *</label><input type="number" id="itemValorUnitario" step="0.01" min="0" placeholder="0,00" required></div>
                </div>
                <button type="button" class="btn btn-primary" onclick="adicionarItem()">‚ûï Adicionar Item</button>
            </div>

            <div class="section">
                <h2>üìã Itens do Or√ßamento</h2>
                <div id="itensContainer"><div class="empty-state"><h3>Nenhum item adicionado</h3></div></div>
            </div>

            <div class="section">
                <h2>üìù Observa√ß√µes</h2>
                <div class="form-group"><textarea id="observacoes" placeholder="Condi√ß√µes de pagamento, prazo de entrega, etc.">Forma de pagamento: 50% na encomenda e 50% na entrega. Prazo de entrega: 30 dias a partir da confirma√ß√£o do pedido.</textarea></div>
            </div>

            <div class="section" style="text-align: center;">
                <button type="button" class="btn btn-success" onclick="gerarPDF()">üìÑ Gerar Or√ßamento em PDF</button>
            </div>
        </div>
        <div style="position: fixed; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 15px; font-size: 11px;">v2.9.0</div>
    </div>
    
    <div id="shareModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header"><h2>üì§ Compartilhar Or√ßamento</h2><p>Escolha como deseja salvar ou compartilhar</p></div>
            <div class="share-options">
                <div class="share-option" onclick="baixarPDF()">
                    <div class="share-option-icon download-icon">üìÑ</div>
                    <div class="share-option-content"><h3>Baixar PDF</h3><p>Documento completo</p></div>
                </div>
                <div class="share-option" onclick="baixarImagem()">
                    <div class="share-option-icon image-icon">üñºÔ∏è</div>
                    <div class="share-option-content"><h3>Baixar Imagem</h3><p>Resumo em JPEG</p></div>
                </div>
                <div class="share-option" onclick="encaminharWhatsApp()">
                    <div class="share-option-icon whatsapp-icon">üí¨</div>
                    <div class="share-option-content"><h3>WhatsApp</h3><p>Enviar para o cliente</p></div>
                </div>
            </div>
            <div class="modal-footer"><button class="btn-close" onclick="fecharModal()">Fechar</button></div>
        </div>
    </div>

    <script>
        let itens = [];
        let contadorItens = 0;
        let pdfGerado = null;
        let dadosOrcamento = null;
        
        function formatarTelefone(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 10) { // Celular com 9¬∫ d√≠gito
                value = value.replace(/^(\d{2})(\d{5})(\d{4}).*/, '($1) $2-$3');
            } else if (value.length > 2) { // Telefone fixo ou celular sem 9¬∫ d√≠gito
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, '($1) $2-$3');
            } else if (value.length > 0) { // Apenas DDD
                value = value.replace(/^(\d*)/, '($1');
            }
            input.value = value;
        }

        function adicionarItem(){const t=document.getElementById("itemDescricao").value.trim(),e=parseInt(document.getElementById("itemQuantidade").value),n=parseFloat(document.getElementById("itemValorUnitario").value);if(t&&e&&n){const a={id:++contadorItens,descricao:t,quantidade:e,valorUnitario:n,valorTotal:e*n};itens.push(a),atualizarTabelaItens(),limparFormularioItem()}else alert("Por favor, preencha todos os campos do item.")}function removerItem(t){itens=itens.filter(e=>e.id!==t),atualizarTabelaItens()}function limparFormularioItem(){document.getElementById("itemDescricao").value="",document.getElementById("itemQuantidade").value="1",document.getElementById("itemValorUnitario").value=""}function formatarMoeda(t){return t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function atualizarTabelaItens(){const t=document.getElementById("itensContainer");if(0===itens.length)return void(t.innerHTML='<div class="empty-state"><h3>Nenhum item adicionado</h3></div>');const e=itens.reduce((t,e)=>t+e.valorTotal,0),n=parseFloat(document.getElementById("descontoValor")?.value)||0,a=e-n;t.innerHTML=`
                <table class="items-table">
                    <thead><tr><th>Descri√ß√£o</th><th>Qtd</th><th>Valor Unit.</th><th>Total</th><th>A√ß√µes</th></tr></thead>
                    <tbody>
                        ${itens.map(t=>`
                            <tr>
                                <td data-label="Descri√ß√£o">${t.descricao}</td>
                                <td data-label="Qtd">${t.quantidade}</td>
                                <td data-label="Valor Unit.">${formatarMoeda(t.valorUnitario)}</td>
                                <td data-label="Total">${formatarMoeda(t.valorTotal)}</td>
                                <td><button class="btn btn-danger" onclick="removerItem(${t.id})">üóëÔ∏è</button></td>
                            </tr>`).join("")}
                    </tbody>
                </table>
                <div class="total-section">
                    <div class="form-grid" style="margin-bottom: 20px; text-align: left;">
                        <div class="form-group">
                            <label for="descontoValor" style="color: white;">Desconto (R$)</label>
                            <input type="number" id="descontoValor" step="0.01" min="0" placeholder="0,00" oninput="atualizarTabelaItens()" style="padding: 12px 15px; border-radius: 10px; border: none; font-size: 1rem;" value="${n>0?n.toFixed(2):""}">
                        </div>
                    </div>
                    <p style="font-size: 1rem; opacity: 0.8; text-align: right;">Subtotal: ${formatarMoeda(e)}</p>
                    <p style="font-size: 1rem; margin-bottom: 10px; opacity: 0.8; text-align: right;">Desconto: - ${formatarMoeda(n)}</p>
                    <h3>Total Geral</h3>
                    <p>${formatarMoeda(a)}</p>
                </div>`}function gerarPDF(){const t=document.getElementById("empresaNome").value.trim(),e=document.getElementById("clienteNome").value.trim();if(t&&e)if(0!==itens.length)dadosOrcamento={empresaNome:t,clienteNome:e,totalGeral:itens.reduce((t,e)=>t+e.valorTotal,0)},criarPDF();else alert("Adicione pelo menos um item ao or√ßamento.");else alert("Por favor, preencha o nome da empresa e do cliente.")}function criarPDF(){const{jsPDF:t}=window.jspdf,e=new t,n=e.internal.pageSize.width,a=15;let o=20;const d=new Image;d.crossOrigin="anonymous",d.onload=function(){const t=60,r=25,i=(n-t)/2;e.addImage(d,"PNG",i,o,t,r),o+=r+5,continuarGeracaoPDF(e,n,a,o)},d.onerror=function(){o+=10,continuarGeracaoPDF(e,n,a,o)},d.src="https://i.imgur.com/zerV906.png"}function continuarGeracaoPDF(t,e,n,a){t.setFontSize(22),t.setFont("helvetica","bold"),t.setTextColor(44,62,80),t.text("OR√áAMENTO",e/2,a,{align:"center"}),a+=15;const o=a;let d=o,r=o;const i=e/2;t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(44,62,80),t.text("DADOS DA EMPRESA",n,d),d+=5,t.setLineWidth(.2),t.line(n,d,i-n/2,d),d+=8,t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(80,80,80);const l=document.getElementById("empresaNome").value.trim(),c=document.getElementById("empresaCNPJ").value.trim(),s=document.getElementById("empresaEndereco").value.trim(),m=document.getElementById("empresaTelefone").value.trim(),u=document.getElementById("empresaEmail").value.trim();t.setFont("helvetica","bold"),t.text(l,n,d),d+=6,t.setFont("helvetica","normal"),c&&t.text(`CNPJ: ${c}`,n,d,d+=5),s&&t.text(s,n,d,d+=5),m&&t.text(`Telefone: ${m}`,n,d,d+=5),u&&t.text(`E-mail: ${u}`,n,d,d+=5),t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(44,62,80),t.text("DADOS DO CLIENTE",i,r),r+=5,t.line(i,r,e-n,r),r+=8,t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(80,80,80);const g=document.getElementById("clienteNome").value.trim(),p=document.getElementById("clienteEmail").value.trim(),h=document.getElementById("clienteTelefone").value.trim();t.setFont("helvetica","bold"),t.text(g,i,r),r+=6,t.setFont("helvetica","normal"),p&&t.text(`E-mail: ${p}`,i,r,r+=5),h&&t.text(`Telefone: ${h}`,i,r,r+=5),a=Math.max(d,r)+15,t.setFontSize(14),t.setFont("helvetica","bold"),t.setTextColor(255,107,53),t.text("ITENS DO OR√áAMENTO:",n,a),a+=12;const b=[["#","Descri√ß√£o","Qtd","V. Unit√°rio","Total"]],f=itens.map((t,e)=>[e+1,t.descricao,t.quantidade,formatarMoeda(t.valorUnitario),formatarMoeda(t.valorTotal)]);"function"==typeof t.autoTable&&(t.autoTable({head:b,body:f,startY:a,theme:"grid",headStyles:{fillColor:[255,107,53],textColor:[255,255,255],fontStyle:"bold",halign:"center"},columnStyles:{0:{halign:"center",cellWidth:10},1:{halign:"left",cellWidth:"auto"},2:{halign:"center",cellWidth:15},3:{halign:"right",cellWidth:30},4:{halign:"right",cellWidth:30}},didDrawPage:t=>{a=t.cursor.y}}),a=t.previousAutoTable.finalY);const E=dadosOrcamento.totalGeral,v=parseFloat(document.getElementById("descontoValor")?.value)||0,y=E-v;a+=10;const x=e/2;t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(80,80,80),t.text("Subtotal:",x,a,{align:"left"}),t.text(formatarMoeda(E),e-n,a,{align:"right"}),a+=7,t.text("Desconto:",x,a,{align:"left"}),t.text(`- ${formatarMoeda(v)}`,e-n,a,{align:"right"}),a+=7,t.setLineWidth(.3),t.setDrawColor(150,150,150),t.line(x,a,e-n,a),a+=8,t.setFontSize(12),t.setFont("helvetica","bold"),t.setTextColor(44,62,80),t.text("TOTAL GERAL:",x,a,{align:"left"}),t.text(formatarMoeda(y),e-n,a,{align:"right"}),a+=15;const w=document.getElementById("observacoes").value.trim();if(w){const o=t.internal.pageSize.height,d=25,r=t.splitTextToSize(w,e-2*n);r.length*5+a+15>o-d&&(t.addPage(),a=20),t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(44,62,80),t.text("OBSERVA√á√ïES",n,a),a+=5,t.setLineWidth(.2),t.line(n,a,60,a),a+=8,t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(80,80,80),t.text(r,n,a)}const N=new Date,I=N.toLocaleDateString("pt-BR"),k=t.internal.getNumberOfPages();for(let o=1;o<=k;o++){t.setPage(o);const d=t.internal.pageSize.height,r=d-15;t.setLineWidth(.3),t.setDrawColor(200,200,200),t.line(n,r,e-n,r),t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(120,120,120),t.text(`Emitido em: ${I}`,n,r+5),t.text("Este or√ßamento tem validade de 30 dias.",e/2,r+5,{align:"center"}),t.text(`P√°gina ${o} de ${k}`,e-n,r+5,{align:"right"})}}
        
        function fecharModal(){document.getElementById("shareModal").style.display="none"}
        function baixarPDF(){if(pdfGerado)pdfGerado.save(`Orcamento_${dadosOrcamento.clienteNome.replace(/\s+/g,"_")}.pdf`)}
        function baixarImagem(){} // L√≥gica de imagem omitida para simplificar
        
        function encaminharWhatsApp() {
            const telefoneCliente = document.getElementById('clienteTelefone').value;
            if (!telefoneCliente) {
                alert('Por favor, preencha o n√∫mero de telefone do cliente.');
                return;
            }

            // Limpa o n√∫mero (remove par√™nteses, espa√ßos, tra√ßos) e adiciona o c√≥digo do Brasil (55)
            const numeroLimpo = '55' + telefoneCliente.replace(/\D/g, '');
            const nomeCliente = dadosOrcamento.clienteNome || 'Cliente';

            const mensagem = `Ol√°, ${nomeCliente}! Segue o or√ßamento solicitado. Por favor, anexe o arquivo PDF que voc√™ acabou de baixar.`;
            const mensagemCodificada = encodeURIComponent(mensagem);

            const url = `https://wa.me/${numeroLimpo}?text=${mensagemCodificada}`;
            
            window.open(url, '_blank');
        }

    </script>
</body>
</html>
